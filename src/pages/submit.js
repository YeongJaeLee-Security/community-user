import React, { useState, FormEvent } from "react";
import Head from "next/head";
import Editor from "@/components/editor";

export default function Page() {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);

  async function onSubmit(event) {
    event.preventDefault();
    setIsLoading(true); // Set loading to true when the request starts
    setError(null);

    const post = {
      title: "Sesac Title",
      content: "Sesac Content",
      date: "2024-10-10",
      author: undefined
    };

    const headers = {
      'Content-Type': 'application/json',
    };

    try {
      // const formData = new FormData(event.currentTarget);
      const response = await fetch("http://localhost:8000/submit", {
        method: "POST",
        body: JSON.stringify(post),
        headers,
        credentials: "include",
      });

      if (!response.ok) {
        throw new Error("Failed to submit data. Please try again");
      }
      alert("Test Post Submitted!");

      // Handle response if necessary
      // ...
    } catch (error) {
      alert(error);
      // Handle error if necessary
      console.error(error);
    } finally {
      setIsLoading(false); // Set loading to false when the request completes
    }
  }

  return (
    <>
      {error && <div style={{ color: "red "}}>{error}</div>}
      <Head>
        <title>Submit to Sesac Community</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <button onClick={onSubmit}>submit</button>
      {/* <Editor
        onSubmit={submitForm}
        isLoading={isLoading}
      ></Editor> */}
    </>
  );
}
